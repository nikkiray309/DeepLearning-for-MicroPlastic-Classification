Epoch 1/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.70it/s]
Epoch [1/100] Train Loss: 0.6804, Train Acc: 0.7683 | Val Loss: 0.4711, Val Acc: 0.8355
Epoch 2/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.06it/s]
Epoch [2/100] Train Loss: 0.4169, Train Acc: 0.8434 | Val Loss: 0.4452, Val Acc: 0.8434
Epoch 3/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.36it/s]
Epoch [3/100] Train Loss: 0.3704, Train Acc: 0.8614 | Val Loss: 0.5148, Val Acc: 0.8105
Epoch 4/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.23it/s]
Epoch [4/100] Train Loss: 0.3525, Train Acc: 0.8669 | Val Loss: 0.4232, Val Acc: 0.8342
Epoch 5/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [5/100] Train Loss: 0.3379, Train Acc: 0.8725 | Val Loss: 0.3244, Val Acc: 0.8750
Epoch 6/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.88it/s]
Epoch [6/100] Train Loss: 0.3238, Train Acc: 0.8752 | Val Loss: 0.4126, Val Acc: 0.8553
Epoch 7/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.22it/s]
Epoch [7/100] Train Loss: 0.3138, Train Acc: 0.8804 | Val Loss: 0.4219, Val Acc: 0.8447
Epoch 8/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.99it/s]
Epoch [8/100] Train Loss: 0.2994, Train Acc: 0.8850 | Val Loss: 0.2929, Val Acc: 0.8974
Epoch 9/100: 100%|██████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.31it/s]
Epoch [9/100] Train Loss: 0.2949, Train Acc: 0.8884 | Val Loss: 0.5206, Val Acc: 0.8053
Epoch 10/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.11it/s]
Epoch [10/100] Train Loss: 0.2877, Train Acc: 0.8885 | Val Loss: 0.3234, Val Acc: 0.8789
Epoch 11/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.94it/s]
Epoch [11/100] Train Loss: 0.2752, Train Acc: 0.8943 | Val Loss: 0.3198, Val Acc: 0.8776
Epoch 12/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.17it/s]
Epoch [12/100] Train Loss: 0.2784, Train Acc: 0.8957 | Val Loss: 0.3182, Val Acc: 0.8803
Epoch 13/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.25it/s]
Epoch [13/100] Train Loss: 0.2626, Train Acc: 0.8980 | Val Loss: 0.3210, Val Acc: 0.8803
Epoch 14/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.04it/s]
Epoch [14/100] Train Loss: 0.2509, Train Acc: 0.9068 | Val Loss: 0.3326, Val Acc: 0.8803
Epoch 15/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.92it/s]
Epoch [15/100] Train Loss: 0.2522, Train Acc: 0.9016 | Val Loss: 0.3038, Val Acc: 0.8882
Epoch 16/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.03it/s]
Epoch [16/100] Train Loss: 0.2501, Train Acc: 0.9055 | Val Loss: 0.3018, Val Acc: 0.8934
Epoch 17/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.00it/s]
Epoch [17/100] Train Loss: 0.2537, Train Acc: 0.9051 | Val Loss: 0.3747, Val Acc: 0.8566
Epoch 18/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.21it/s]
Epoch [18/100] Train Loss: 0.2366, Train Acc: 0.9119 | Val Loss: 0.2631, Val Acc: 0.9039
Epoch 19/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.03it/s]
Epoch [19/100] Train Loss: 0.2359, Train Acc: 0.9102 | Val Loss: 0.3262, Val Acc: 0.8829
Epoch 20/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.11it/s]
Epoch [20/100] Train Loss: 0.2378, Train Acc: 0.9099 | Val Loss: 0.2764, Val Acc: 0.8961
Epoch 21/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.99it/s]
Epoch [21/100] Train Loss: 0.2333, Train Acc: 0.9128 | Val Loss: 0.2582, Val Acc: 0.9079
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch [16/100] Train Loss: 0.2501, Train Acc: 0.9055 | Val Loss: 0.3018, Val Acc: 0.8934
Epoch 17/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.00it/s]
Epoch [17/100] Train Loss: 0.2537, Train Acc: 0.9051 | Val Loss: 0.3747, Val Acc: 0.8566
Epoch 18/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.21it/s]
Epoch [18/100] Train Loss: 0.2366, Train Acc: 0.9119 | Val Loss: 0.2631, Val Acc: 0.9039
Epoch 19/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.03it/s]
Epoch [19/100] Train Loss: 0.2359, Train Acc: 0.9102 | Val Loss: 0.3262, Val Acc: 0.8829
Epoch 20/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.11it/s]
Epoch [20/100] Train Loss: 0.2378, Train Acc: 0.9099 | Val Loss: 0.2764, Val Acc: 0.8961
Epoch 21/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.99it/s]
Epoch [21/100] Train Loss: 0.2333, Train Acc: 0.9128 | Val Loss: 0.2582, Val Acc: 0.9079
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch [17/100] Train Loss: 0.2537, Train Acc: 0.9051 | Val Loss: 0.3747, Val Acc: 0.8566
Epoch 18/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.21it/s]
Epoch [18/100] Train Loss: 0.2366, Train Acc: 0.9119 | Val Loss: 0.2631, Val Acc: 0.9039
Epoch 19/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.03it/s]
Epoch [19/100] Train Loss: 0.2359, Train Acc: 0.9102 | Val Loss: 0.3262, Val Acc: 0.8829
Epoch 20/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.11it/s]
Epoch [20/100] Train Loss: 0.2378, Train Acc: 0.9099 | Val Loss: 0.2764, Val Acc: 0.8961
Epoch 21/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.99it/s]
Epoch [21/100] Train Loss: 0.2333, Train Acc: 0.9128 | Val Loss: 0.2582, Val Acc: 0.9079
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch 20/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.11it/s]
Epoch [20/100] Train Loss: 0.2378, Train Acc: 0.9099 | Val Loss: 0.2764, Val Acc: 0.8961
Epoch 21/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.99it/s]
Epoch [21/100] Train Loss: 0.2333, Train Acc: 0.9128 | Val Loss: 0.2582, Val Acc: 0.9079
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch 21/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.99it/s]
Epoch [21/100] Train Loss: 0.2333, Train Acc: 0.9128 | Val Loss: 0.2582, Val Acc: 0.9079
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch [21/100] Train Loss: 0.2333, Train Acc: 0.9128 | Val Loss: 0.2582, Val Acc: 0.9079
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch 22/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.12it/s]
Epoch [22/100] Train Loss: 0.2346, Train Acc: 0.9114 | Val Loss: 0.2937, Val Acc: 0.8947
Epoch 23/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.01it/s]
Epoch [23/100] Train Loss: 0.2316, Train Acc: 0.9130 | Val Loss: 0.3180, Val Acc: 0.8908
Epoch 24/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.01it/s]
Epoch [24/100] Train Loss: 0.2322, Train Acc: 0.9102 | Val Loss: 0.2823, Val Acc: 0.9000
Epoch 25/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.16it/s]
Epoch [25/100] Train Loss: 0.2317, Train Acc: 0.9092 | Val Loss: 0.2760, Val Acc: 0.8987
Epoch 26/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.08it/s]
Epoch [26/100] Train Loss: 0.2233, Train Acc: 0.9155 | Val Loss: 0.2852, Val Acc: 0.8974
Epoch 27/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.39it/s]
Epoch [27/100] Train Loss: 0.2167, Train Acc: 0.9191 | Val Loss: 0.2967, Val Acc: 0.8947
Epoch 28/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.17it/s]
Epoch [28/100] Train Loss: 0.2211, Train Acc: 0.9152 | Val Loss: 0.2807, Val Acc: 0.9000
Epoch 29/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 27.91it/s]
Epoch [29/100] Train Loss: 0.2235, Train Acc: 0.9150 | Val Loss: 0.2832, Val Acc: 0.9000
Epoch 30/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.13it/s]
Epoch [30/100] Train Loss: 0.2195, Train Acc: 0.9163 | Val Loss: 0.3133, Val Acc: 0.8882
Epoch 31/100: 100%|█████████████████████████████████████████████████████| 465/465 [00:16<00:00, 28.26it/s]
Epoch [31/100] Train Loss: 0.2220, Train Acc: 0.9165 | Val Loss: 0.3025, Val Acc: 0.8934
Early stopping triggered.
Test Classification Report:
              precision    recall  f1-score   support

        foam       0.87      1.00      0.93        20
        hard       0.99      0.92      0.95       532
        line       0.85      0.97      0.91        95
       noise       0.85      0.96      0.90        46
      pellet       0.72      0.92      0.81        60
   reference       1.00      1.00      1.00         8

    accuracy                           0.93       761
   macro avg       0.88      0.96      0.92       761
weighted avg       0.94      0.93      0.93       761
